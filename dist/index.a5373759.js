window.SNAKE||(window.SNAKE={});const e="jsSnakeHighScore";SNAKE.addEventListener=window.addEventListener?function(e,t,n,a){e.addEventListener(t,n,a)}:window.attachEvent?function(e,t,n){e.attachEvent("on"+t,n)}:void 0,SNAKE.removeEventListener=window.removeEventListener?function(e,t,n,a){e.removeEventListener(t,n,a)}:window.detachEvent?function(e,t,n){e.detachEvent("on"+t,n)}:void 0,SNAKE.Snake=SNAKE.Snake||function(){let t=[],n=function(){this.elm=null,this.elmStyle=null,this.row=-1,this.col=-1,this.next=null,this.prev=null};return function(a){let o;if(!a||!a.playingBoard)return;void 0===localStorage[e]&&localStorage.setItem(e,0);let l=this,d=a.playingBoard,i=[0,1,0,-1],s=[-1,0,1,0],r=1,c=-1,u=!0,m=-1,p=80,h=!1,g=!1,k=document.getElementById("selectMode");function y(e){let t=e.row*d.getBlockHeight();return`${t}px`}function f(e){let t=e.col*d.getBlockWidth();return`${t}px`}function v(){let e=document.createElement("div");return e.className="snake-snakebody-block",e.style.left="-1000px",e.style.top="-1000px",e.style.width=d.getBlockWidth()+"px",e.style.height=d.getBlockHeight()+"px",e}function w(e){let a;let o=v();for(let l=1;l<e;l++)(a=new n).elm=o.cloneNode(!0),a.elmStyle=a.elm.style,d.getBoardContainer().appendChild(a.elm),t[t.length]=a;(a=new n).elm=o,d.getBoardContainer().appendChild(a.elm),t[t.length]=a}function S(t){(function(){let t=localStorage[e];l.snakeLength>t&&(alert("Congratulations! You have beaten your previous high score, which was "+t+"."),localStorage.setItem(e,l.snakeLength))})(),l.snakeHead.elm.style.zIndex=function(e){let t=0,n=0,a;for(a in e)e[a].elm.currentStyle?n=parseFloat(e[a].elm.style["z-index"],10):window.getComputedStyle&&(n=parseFloat(document.defaultView.getComputedStyle(e[a].elm,null).getPropertyValue("z-index"),10)),!isNaN(n)&&n>t&&(t=n);return t+1}(l.snakeBody),l.snakeHead.elm.className=l.snakeHead.elm.className.replace(/\bsnake-snakebody-alive\b/,""),l.snakeHead.elm.className+=" snake-snakebody-dead",h=!0,t()}k&&k.addEventListener("change",function(e){let t=(e=e||{}).target?parseInt(e.target.value):80;isNaN(t)?t=80:t<25&&(t=80),p=t,setTimeout(function(){document.getElementById("game-area").focus()},10)}),l.snakeBody={},l.snakeBody.b0=new n,l.snakeBody.b0.row=a.startRow||1,l.snakeBody.b0.col=a.startCol||1,l.snakeBody.b0.elm=v(),l.snakeBody.b0.elmStyle=l.snakeBody.b0.elm.style,d.getBoardContainer().appendChild(l.snakeBody.b0.elm),l.snakeBody.b0.elm.style.left=f(l.snakeBody.b0),l.snakeBody.b0.elm.style.top=y(l.snakeBody.b0),l.snakeBody.b0.next=l.snakeBody.b0,l.snakeBody.b0.prev=l.snakeBody.b0,l.snakeLength=1,l.snakeHead=l.snakeBody.b0,l.snakeTail=l.snakeBody.b0,l.snakeHead.elm.className=l.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),l.snakeHead.elm.id="snake-snakehead-alive",l.snakeHead.elm.className+=" snake-snakebody-alive",l.setPaused=function(e){g=e},l.getPaused=function(){return g},l.setDirection=e=>{m!==r&&(c=e),(2!==Math.abs(e-r)||u)&&(m=e,u=!1)},l.handleArrowKeys=function(e){if(h||g&&!a.premoveOnPause)return;let t=-1;switch(e){case 37:case 65:t=3;break;case 38:case 87:t=0;break;case 39:case 68:t=1;break;case 40:case 83:t=2}l.setDirection(t)},l.go=function(){let e=l.snakeHead,t=l.snakeTail,n=d.grid;if(!0===g){setTimeout(function(){l.go()},p);return}if(a.moveSnakeWithAI&&a.moveSnakeWithAI({grid:n,snakeHead:l.snakeHead,currentDirection:m,isFirstGameMove:u,setDirection:l.setDirection}),l.snakeTail=t.prev,l.snakeHead=t,n[t.row]&&n[t.row][t.col]&&(n[t.row][t.col]=0),-1!==m&&(r=m,-1!==c&&(m=c,c=-1)),t.col=e.col+i[r],t.row=e.row+s[r],t.elmStyle||(t.elmStyle=t.elm.style),t.elmStyle.left=f(t),t.elmStyle.top=y(t),l.snakeLength>1&&(t.elm.id="snake-snakehead-alive",e.elm.id=""),0===n[t.row][t.col])n[t.row][t.col]=1,setTimeout(function(){l.go()},p);else if(n[t.row][t.col]>0)l.handleDeath();else if(n[t.row][t.col]===d.getGridFoodValue()){if(n[t.row][t.col]=1,!l.eatFood()){l.handleWin();return}setTimeout(function(){l.go()},p)}},l.eatFood=function(){t.length<=5&&w(10);let e=t.splice(0,5),n=e.length,a;for(o=l.snakeTail;n--;)a="b"+l.snakeLength++,l.snakeBody[a]=e[n],l.snakeBody[a].prev=o,l.snakeBody[a].elm.className=l.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),l.snakeBody[a].elm.className+=" snake-snakebody-alive",o.next=l.snakeBody[a],o=l.snakeBody[a];if(l.snakeTail=l.snakeBody[a],l.snakeTail.next=l.snakeHead,l.snakeHead.prev=l.snakeTail,!d.foodEaten())return!1;let i=document.getElementById("selectMode");return 0==i.options[i.selectedIndex].text.localeCompare("Rush")&&p>30&&(p-=5),!0},l.handleDeath=function(){p=parseInt(document.getElementById("selectMode").value),S(d.handleDeath)},l.handleWin=function(){S(d.handleWin)},l.rebirth=function(){h=!1,u=!0,c=-1},l.reset=function(){let e;if(!1===h)return;let n=[],o=l.snakeHead.next;for(;o!==l.snakeHead;)e=o.next,o.prev=null,o.next=null,n.push(o),o=e;l.snakeHead.next=l.snakeHead,l.snakeHead.prev=l.snakeHead,l.snakeTail=l.snakeHead,l.snakeLength=1;for(let e=0;e<n.length;e++)n[e].elm.style.left="-1000px",n[e].elm.style.top="-1000px",n[e].elm.className=l.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),n[e].elm.className+=" snake-snakebody-alive";t.concat(n),l.snakeHead.elm.className=l.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),l.snakeHead.elm.className+=" snake-snakebody-alive",l.snakeHead.elm.id="snake-snakehead-alive",l.snakeHead.row=a.startRow||1,l.snakeHead.col=a.startCol||1,l.snakeHead.elm.style.left=f(l.snakeHead),l.snakeHead.elm.style.top=y(l.snakeHead)},l.getSpeed=()=>p,l.setSpeed=e=>{p=e},w(10)}}(),SNAKE.Food=SNAKE.Food||function(){let e=0;function t(e,t){return Math.floor(Math.random()*(t+1-e))+e}return function(n){let a,o;if(!n||!n.playingBoard)return;let l=n.playingBoard,d=e++,i=document.createElement("div");i.setAttribute("id","snake-food-"+d),i.className="snake-food-block",i.style.width=l.getBlockWidth()+"px",i.style.height=l.getBlockHeight()+"px",i.style.left="-1000px",i.style.top="-1000px",l.getBoardContainer().appendChild(i),this.getFoodElement=function(){return i},this.randomlyPlaceFood=function(){l.grid[a]&&l.grid[a][o]===l.getGridFoodValue()&&(l.grid[a][o]=0);let e=0,n=0,d=0,s=l.grid.length-1,r=l.grid[0].length-1;for(;0!==l.grid[e][n];)if(e=t(1,s),n=t(1,r),++d>2e4)return!1;return l.grid[e][n]=l.getGridFoodValue(),a=e,o=n,i.style.top=e*l.getBlockHeight()+"px",i.style.left=n*l.getBlockWidth()+"px",!0}}}(),SNAKE.Board=SNAKE.Board||function(){let t=0;function n(e){let t=0,n=0,a;for(a in e)e[a].elm.currentStyle?n=parseFloat(e[a].elm.style["z-index"],10):window.getComputedStyle&&(n=parseFloat(document.defaultView.getComputedStyle(e[a].elm,null).getPropertyValue("z-index"),10)),!isNaN(n)&&n>t&&(t=n);return t+1}return function(a){let o,l,d,i,s,r,c,u,m;let p=this,h=t++,g=a||{};g.onLengthUpdate||(g.onLengthUpdate=()=>{}),g.onPauseToggle||(g.onPauseToggle=()=>{}),g.onWin||(g.onWin=()=>{}),g.onDeath||(g.onDeath=()=>{});let k,y,f=1,v,w,S=!1;function B(){return g.startRow||2}function b(){return g.startCol||2}function E(e,t,n){let a=document.createElement("div");a.id=t+h,a.className=n;let o=document.createElement("div");o.innerHTML="JavaScript Snake<p></p>"+e+"<p></p>";let l=document.createElement("button");l.appendChild(document.createTextNode("Play Again?"));let d=function(){a.style.display="none",p.resetBoard(),p.setBoardState(1),p.getBoardContainer().focus()};return SNAKE.addEventListener(window,"keyup",function(e){if(0!==f||"block"!==a.style.display)return;e||(e=window.event);let t=e.which?e.which:e.keyCode;(32===t||13===t)&&d()},!0),SNAKE.addEventListener(l,"click",d,!1),a.appendChild(o),a.appendChild(l),a}function H(e){let t=Math.max(n(y.snakeBody),n({tmp:{elm:k.getFoodElement()}}));e&&(o.removeChild(e),o.appendChild(e),e.style.zIndex=t,e.style.display="block"),p.setBoardState(0)}p.grid=[],p.setPaused=function(e){S=e,y.setPaused(e),S?m.style.display="block":m.style.display="none",g.onPauseToggle(S)},p.getPaused=function(){return S},p.resetBoard=function(){SNAKE.removeEventListener(o,"keydown",v,!1),SNAKE.removeEventListener(o,"visibilitychange",w,!1),y.reset(),g.onLengthUpdate(1),i.innerHTML="Length: 1",p.setupPlayingField(),p.grid[B()][b()]=1},p.getBoardState=function(){return f},p.setBoardState=function(e){f=e},p.getGridFoodValue=function(){return -1},p.getPlayingFieldElement=function(){return l},p.setBoardContainer=function(e){"string"==typeof e&&(e=document.getElementById(e)),e!==o&&(o=e,l=null,p.setupPlayingField(),p.grid[B()][b()]=1)},p.getBoardContainer=function(){return o},p.getBlockWidth=function(){return 20},p.getBlockHeight=function(){return 20},p.setupPlayingField=function(){let t,n,a,f;if(!l&&((l=document.createElement("div")).setAttribute("id","playingField"),l.className="snake-playing-field",SNAKE.addEventListener(l,"click",function(){o.focus()},!1),(m=document.createElement("div")).className="snake-pause-screen",m.innerHTML="<div style='padding:10px;'>[Paused]<p/>Press [space] to unpause.</div>",(d=document.createElement("div")).className="snake-panel-component",d.innerHTML="<a href='http://patorjk.com/blog/software/' class='snake-link'>more patorjk.com apps</a> - <a href='https://github.com/patorjk/JavaScript-Snake' class='snake-link'>source code</a> - <a href='https://www.youtube.com/channel/UCpcCLm9y6CsjHUrCvJHYHUA' class='snake-link'>pat's youtube</a>",(i=document.createElement("div")).className="snake-panel-component",i.innerHTML="Length: 1",(s=document.createElement("div")).className="snake-panel-component",s.innerHTML="Highscore: "+(localStorage[e]||0),g.moveSnakeWithAI||(r=function(){let e=document.createElement("div");e.id="sbWelcome"+h,e.className="snake-welcome-dialog";let t=document.createElement("div"),n="";g.fullScreen&&(n="On Windows, press F11 to play in Full Screen mode."),t.innerHTML="JavaScript Snake<p></p>Use the <strong>arrow keys</strong> on your keyboard to play the game. "+n+"<p></p>";let a=document.createElement("button");a.appendChild(document.createTextNode("Play Game"));let o=function(){SNAKE.removeEventListener(window,"keyup",l,!1),e.style.display="none",p.setBoardState(1),p.getBoardContainer().focus()},l=function(e){e||(e=window.event);let t=e.which?e.which:e.keyCode;(32===t||13===t)&&o()};return SNAKE.addEventListener(window,"keyup",l,!1),SNAKE.addEventListener(a,"click",o,!1),e.appendChild(t),e.appendChild(a),e}(),c=E("You died :(","sbTryAgain","snake-try-again-dialog"),u=E("You win! :D","sbWin","snake-win-dialog")),SNAKE.addEventListener(o,"keyup",function(e){return e||(e=window.event),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1},!1),o.className="snake-game-container",m.style.zIndex=1e4,o.appendChild(m),o.appendChild(l),o.appendChild(d),o.appendChild(i),o.appendChild(s),g.moveSnakeWithAI||(o.appendChild(r),o.appendChild(c),o.appendChild(u)),y=new SNAKE.Snake({playingBoard:p,startRow:B(),startCol:b(),premoveOnPause:g.premoveOnPause,moveSnakeWithAI:g.moveSnakeWithAI}),k=new SNAKE.Food({playingBoard:p}),r&&(r.style.zIndex=1e3)),!0===g.fullScreen){let e,o;a=0,f=0,e=0,"number"==typeof window.innerWidth?e=window.innerWidth:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?e=document.documentElement.clientWidth:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientWidth),t=e-20,o=0,"number"==typeof window.innerHeight?o=window.innerHeight:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?o=document.documentElement.clientHeight:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(o=document.body.clientHeight),n=o-20}else a=g.top,f=g.left,t=g.width,n=g.height;let S=2*p.getBlockWidth()+t%p.getBlockWidth(),H=Math.min(250*p.getBlockWidth()-S,t-S),N=3*p.getBlockHeight()+n%p.getBlockHeight(),L=Math.min(250*p.getBlockHeight()-N,n-N);o.style.left=f+"px",o.style.top=a+"px",o.style.width=t+"px",o.style.height=n+"px",l.style.left=p.getBlockWidth()+"px",l.style.top=p.getBlockHeight()+"px",l.style.width=H+"px",l.style.height=L+"px";let A=N-p.getBlockHeight(),C=p.getBlockHeight()+L+Math.round((A-30)/2)+"px";d.style.top=C,d.style.width="450px",d.style.left=Math.round(t/2)-Math.round(225)+"px",i.style.top=C,i.style.left="30px",s.style.top=C,s.style.left=t-140+"px",t<700?d.style.display="none":d.style.display="block",p.grid=[];let x=H/p.getBlockWidth()+2,P=L/p.getBlockHeight()+2;for(let e=0;e<P;e++){p.grid[e]=[];for(let t=0;t<x;t++)0===t||0===e||t===x-1||e===P-1?p.grid[e][t]=1:p.grid[e][t]=0}k.randomlyPlaceFood(),g.onLengthUpdate(1),v=function(e){e||(e=window.event);let t=e.which?e.which:e.keyCode;if(1===p.getBoardState()){if(!(t>=37&&t<=40)&&87!==t&&65!==t&&83!==t&&68!==t)return;SNAKE.removeEventListener(o,"keydown",v,!1),SNAKE.removeEventListener(o,"visibilitychange",w,!1),v=function(e){e||(e=window.event);let t=e.which?e.which:e.keyCode;return 32===t&&0!=p.getBoardState()&&p.setPaused(!p.getPaused()),y.handleArrowKeys(t),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1},document.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||0==p.getBoardState()||p.getPaused()||p.setPaused(!0)}),SNAKE.addEventListener(o,"keydown",v,!1),SNAKE.addEventListener(o,"visibilitychange",w,!1),y.rebirth(),y.handleArrowKeys(t),p.setBoardState(2),y.go()}return e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1},g.moveSnakeWithAI||(SNAKE.addEventListener(o,"keydown",v,!1),SNAKE.addEventListener(o,"visibilitychange",w,!1))},p.foodEaten=function(){return g.onLengthUpdate(y.snakeLength),i.innerHTML="Length: "+y.snakeLength,y.snakeLength>localStorage[e]&&(localStorage.setItem(e,y.snakeLength),s.innerHTML="Highscore: "+localStorage[e]),!!k.randomlyPlaceFood()},p.handleDeath=function(){H(c),g.onDeath({startAIGame:p.startAIGame})},p.handleWin=function(){H(u),g.onWin({startAIGame:p.startAIGame})},p.setSpeed=e=>{y.setSpeed(e)},p.getSpeed=()=>y.getSpeed(),p.startAIGame=()=>{p.resetBoard(),y.rebirth(),p.setBoardState(2),y.go()},g.fullScreen=void 0!==g.fullScreen&&g.fullScreen,g.top=void 0===g.top?0:g.top,g.left=void 0===g.left?0:g.left,g.width=void 0===g.width?400:g.width,g.height=void 0===g.height?400:g.height,g.premoveOnPause=void 0!==g.premoveOnPause&&g.premoveOnPause,g.fullScreen&&SNAKE.addEventListener(window,"resize",function(){p.setupPlayingField()},!1),p.setBoardState(0),g.boardContainer&&p.setBoardContainer(g.boardContainer),g.onInit&&g.onInit({reloadGame:function(){p.resetBoard(),p.setBoardState(1),p.getBoardContainer().focus()},getSpeed:p.getSpeed,setSpeed:p.setSpeed,startAIGame:p.startAIGame})}}();
//# sourceMappingURL=index.a5373759.js.map
